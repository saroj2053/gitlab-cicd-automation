FROM node:18-alpine

WORKDIR /usr/app

ENV GITLAB_USERNAME=sarojsah
ENV GITLAB_ACCESS_TOKEN=glpat-BfXDjobMs5eyE7YznzNg
ENV GITLAB_URL=gitlab.com/dev5185536/gitlab_cicd_assessment_task.git

RUN apk add --no-cache git

RUN git config --global user.name "sarojsah" \
    && git config --global user.email "saroj.js.sah1997@gmail.com" 

COPY package*.json ./

RUN npm install

COPY . .

WORKDIR /usr/app/frontend
RUN npm install
RUN npm run build

WORKDIR /usr/app/backend
RUN npm install

EXPOSE 8080

CMD [ "npm", "run", "dev"]



